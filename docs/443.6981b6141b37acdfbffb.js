(self.webpackChunknotebookreact=self.webpackChunknotebookreact||[]).push([[443],{2443:(e,o,t)=>{"use strict";t.r(o),t.d(o,{default:()=>d});var a=t(7294),n=t(9669),l=t.n(n),s=t(3727),r=t(5977),c=t(195),i=t(9791),f=t(2433),u=t(7356);const p=function(e){const{username:o}=(0,r.UO)(),[t,n]=(0,a.useState)(!0),[s,c]=(0,a.useState)([]);return(0,a.useEffect)((()=>{const e=l().CancelToken.source();return async function(){try{const t=await l().get(`/profile/${o}/posts`,{cancelToken:e.token});n(!1),c(t.data)}catch(e){console.log("ops, nope again!")}}(),()=>e.cancel("landing has been interepted")}),[o]),t?a.createElement(i.Z,{title:o},a.createElement(u.Z,null)):a.createElement("div",{className:"list-group"},s.map((e=>a.createElement(f.Z,{post:e,key:e._id,isProfile:!0}))))};var m=t(2230),w=t(7267);const g=function(e){const{username:o}=(0,r.UO)(),[t,n]=(0,a.useState)(!0),[c,f]=(0,a.useState)([]);return(0,a.useEffect)((()=>{const t=l().CancelToken.source();return async function(){try{const a=await l().get(`/profile/${o}/${e.action}`,{cancelToken:t.token});console.log(a.data),n(!1),f(a.data)}catch(e){console.log("ops, nope again!")}}(),()=>t.cancel("landing has been interepted")}),[o,e.action,e.followAction]),t?a.createElement(i.Z,{title:o},a.createElement(u.Z,null)):c.length?a.createElement("div",{className:"list-group"},c.map(((e,o)=>a.createElement(s.rU,{key:o,to:`/profile/${e.username}`,className:"list-group-item list-group-item-action"},a.createElement("img",{className:"avatar-tiny",src:e.avatar})," ",a.createElement("strong",null,e.username))))):a.createElement("div",{className:"container py-md-5 container--narrow"},a.createElement("div",{className:"text-center"},a.createElement("h2",null,"this Profile has no ","followers"==e.action?"followers":"followings"," currently?")))},d=function(e){const o=(0,a.useContext)(w.Z),t=(0,a.useContext)(m.Z),{username:n}=(0,r.UO)(),[f,u]=(0,c.x)({actionLoading:!1,startFollowRequestCount:0,stopFollowRequestCount:0,followAction:0,profileData:{profileUsername:"...",profileAvatar:"https://www.gravatar.com/avatar/placeholder/?s=128",isFollowing:!1,counts:{postCount:"",followerCount:"",followingCount:""}}});return(0,a.useEffect)((()=>{const e=l().CancelToken.source();return async function(){try{const t=await l().post(`/profile/${n}`,{token:o.user.token},{cancelToken:e.token});u((e=>{e.profileData=t.data}))}catch(e){console.log("nope!")}}(),()=>e.cancel("landing has been interepted")}),[n]),(0,a.useEffect)((()=>{if(f.startFollowRequestCount){u((e=>{e.actionLoading=!0}));const e=l().CancelToken.source();return async function(){try{await l().post(`/addFollow/${f.profileData.profileUsername}`,{token:o.user.token},{cancelToken:e.token}),u((e=>{e.profileData.isFollowing=!0,e.followAction++,e.profileData.counts.followerCount++,e.actionLoading=!1})),t({type:"flashMessage",value:{msg:`you've successfully started following ${f.profileData.profileUsername}`,mode:"success"}})}catch(e){console.log("ops, we ran into a problem!")}}(),()=>e.cancel()}}),[f.startFollowRequestCount]),(0,a.useEffect)((()=>{if(f.stopFollowRequestCount){u((e=>{e.actionLoading=!0}));const e=l().CancelToken.source();return async function(){try{await l().post(`/removeFollow/${f.profileData.profileUsername}`,{token:o.user.token},{cancelToken:e.token}),u((e=>{e.profileData.isFollowing=!1,e.followAction--,e.profileData.counts.followerCount--,e.actionLoading=!1})),t({type:"flashMessage",value:{msg:`you've successfully stopped following ${f.profileData.profileUsername}`,mode:"success"}})}catch(e){console.log("ops, we ran into a problem!")}}(),()=>e.cancel()}}),[f.stopFollowRequestCount]),a.createElement(i.Z,{title:f.profileData.profileUsername},a.createElement("h2",null,a.createElement("img",{className:"avatar-small",src:f.profileData.profileAvatar})," ",f.profileData.profileUsername,"..."!=f.profileData.profileUsername&&f.profileData.profileUsername!=o.user.username&&!f.profileData.isFollowing&&o.loggedIn&&a.createElement("button",{onClick:function(){u((e=>{e.startFollowRequestCount++}))},disabled:f.actionLoading,className:"btn btn-primary btn-sm ml-2"},"Follow ",a.createElement("i",{className:"fas fa-user-plus"})),"..."!=f.profileData.profileUsername&&f.profileData.profileUsername!=o.user.username&&f.profileData.isFollowing&&o.loggedIn&&a.createElement("button",{onClick:function(){u((e=>{e.stopFollowRequestCount++}))},disabled:f.actionLoading,className:"btn btn-danger btn-sm ml-2"},"stop Follow ",a.createElement("i",{className:"fas fa-user-times"}))),a.createElement("div",{className:"profile-nav nav nav-tabs pt-2 mb-4"},a.createElement(s.OL,{exact:!0,to:`/profile/${f.profileData.profileUsername}`,className:"nav-item nav-link"},"Posts: ",f.profileData.counts.postCount),a.createElement(s.OL,{to:`/profile/${f.profileData.profileUsername}/followers`,className:"nav-item nav-link"},"Followers: ",f.profileData.counts.followerCount),a.createElement(s.OL,{to:`/profile/${f.profileData.profileUsername}/following`,className:"nav-item nav-link"},"Following: ",f.profileData.counts.followingCount)),a.createElement(r.rs,null,a.createElement(r.AW,{exact:!0,path:"/profile/:username"},a.createElement(p,null)),a.createElement(r.AW,{path:"/profile/:username/followers"},a.createElement(g,{action:"followers",followAction:f.followAction})),a.createElement(r.AW,{path:"/profile/:username/following"},a.createElement(g,{action:"following",followAction:f.followAction}))))}}}]);